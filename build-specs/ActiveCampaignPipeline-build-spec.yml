version: 0.2

phases:
  install:
    commands:
      - npm install -g npm || npm -g install yarn
      - yarn install --frozen-lockfile
      - /bin/bash ./git-secret-scan.sh
  build:
    commands:
      - yarn test
      - yarn cdk synthesize ActiveCampaignPipelineTestStack
      - yarn bump
      - git push --follow-tags origin v1-main

artifacts:
  base-directory: cdk.out
  files:
    - '**.*'
